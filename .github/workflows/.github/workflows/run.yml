name: Run Any Script Forever

on:
  workflow_dispatch:

jobs:
  run-forever:
    runs-on: ubuntu-latest
    timeout-minutes: 360  # الحد الأقصى 6 ساعات لكل job

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install runtimes
        run: |
          # Node.js
          curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
          sudo apt-get install -y nodejs
          # Python
          sudo apt-get install -y python3 python3-pip
          # Ruby
          sudo apt-get install -y ruby-full
          # Java
          sudo apt-get install -y default-jdk
          # Bash
          sudo apt-get install -y bash

      - name: Run scripts in infinite loop
        run: |
          while true; do
            for f in *.*; do
              case "$f" in
                *.js)
                  echo "Running Node.js: $f"
                  npm install 2>/dev/null || true
                  node "$f"
                  ;;
                *.py)
                  echo "Running Python: $f"
                  pip install -r requirements.txt 2>/dev/null || true
                  python3 "$f"
                  ;;
                *.sh)
                  echo "Running Bash: $f"
                  chmod +x "$f"
                  ./"$f"
                  ;;
                *.rb)
                  echo "Running Ruby: $f"
                  ruby "$f"
                  ;;
                *.java)
                  echo "Running Java: $f"
                  javac "$f"
                  java "${f%.java}"
                  ;;
                *.pl)
                  echo "Running Perl: $f"
                  perl "$f"
                  ;;
                *)
                  echo "Skipping $f (unknown type)"
                  ;;
              esac
            done
            echo "All scripts finished, restarting loop..."
            sleep 2
          done
